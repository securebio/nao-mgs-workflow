nextflow_process {

    name "Test process RAISE_TAXONOMY_RANKS"
    script "modules/local/raiseTaxonomyRanks/main.nf"
    process "RAISE_TAXONOMY_RANKS"
    config "tests/configs/run.config"
    tag "module"
    tag "raise_taxonomy_ranks"

    test("End-to-end crash test with valid input"){
        tag "expect_success"
        tag "valid_input"
        when {
            params {
                taxonomy_db = "${projectDir}/test-data/toy-data/test-taxonomy-ranked.tsv"
                target_ranks = "species genus family"
            }
            process {
                '''
                input[0] = params.taxonomy_db
                input[1] = params.target_ranks
                '''
            }
        }
        then {
            // Should run without errors
            assert process.success
            // Output should be created
            assert path(process.out.db[0]).exists()
        }
    }
}
