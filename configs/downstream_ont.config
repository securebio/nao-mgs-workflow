/*
========================================================================================
    Nextflow config file for running tests
========================================================================================
*/
/*********************************************
| CONFIGURATION FILE FOR DOWNSTREAM WORKFLOW |
*********************************************/

params {
    mode = "downstream"

    // Sequencing platform
    platform = "ont"  // For other platforms ("illumina", "pacbio", "aviti"), instead start with downstream.config

    // Directories
    base_dir = <PATH_TO_DIRECTORY> // Parent for working and output directories (can be S3)
    ref_dir = <PATH TO REFERENCE DIRECTORY> // Reference/index directory (generated by index workflow)

    // Files
    input_file = "${launchDir}/input.csv"

    // Other required parameters
    aln_dup_deviation = 1 // Not used for ONT, but included for compatibility
    validation_cluster_identity = 1 // Minimum sequence identity for cluster formation during viral hit validation
    validation_n_clusters = 1000000 // Maximum clusters per species to validate during viral hit validation
    blast_db_prefix = "core_nt" // Prefix for BLAST database
    blast_perc_id = 0 // Percent identity threshold for BLAST hits
    blast_qcov_hsp_perc = 0 // Query coverage threshold for BLAST hits
    blast_min_frac = 0.9 // Keep BLAST hits whose bitscore is at least this fraction of the best bitscore for that query
    blast_max_rank = 5 // Keep BLAST hits whose dense bitscore rank for that query is at most this value
    taxid_artificial = 81077 // Parent taxid for artificial sequences
}

includeConfig "${projectDir}/configs/logging_downstream.config"
includeConfig "${projectDir}/configs/containers.config"
includeConfig "${projectDir}/configs/resources.config"
includeConfig "${projectDir}/configs/profiles.config"
includeConfig "${projectDir}/configs/output.config"
process.queue = <JOB_QUEUE_NAME> // AWS Batch job queue
